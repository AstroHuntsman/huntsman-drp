<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Overview &mdash; huntsman-drp 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Integration with LSST" href="lsst.html" />
    <link rel="prev" title="huntsman-drp" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> huntsman-drp
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#scope">Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="#services">Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fileingestor">FileIngestor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calibservice">CalibService</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qualitymonitor">QualityMonitor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lsst.html">Integration with LSST</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="module.html">Module Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">huntsman-drp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Overview</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/overview.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h1>
<section id="scope">
<h2>Scope<a class="headerlink" href="#scope" title="Permalink to this headline"></a></h2>
<p>When data is moved moved from the Huntsman observatory control computer, it gets stored in a
directory on <code class="docutils literal notranslate"><span class="pre">dccompute3</span></code> (the raw data directory) with the same filename and base directory
structure as the original file. It is the responsibility of the observatory control software to
ensure filenames are unique, for example by including the time of observation in the filename.</p>
<p><code class="docutils literal notranslate"><span class="pre">huntsman-drp</span></code> aims to ingest incoming files as they arrive on the filesystem, placing their metadata
inside the databse. Master calibration files are produced automatically on regular intervals. Additional
data quality metrics for calibrated science files (e.g. PSF FWHM and zeropoint) are automatically
gathered as soon as a full set of appropriate calibration files becomes available. These tasks are
accomplished asyncronously through several long-running services.</p>
</section>
<section id="services">
<h2>Services<a class="headerlink" href="#services" title="Permalink to this headline"></a></h2>
<section id="fileingestor">
<h3>FileIngestor<a class="headerlink" href="#fileingestor" title="Permalink to this headline"></a></h3>
<p>It is the job of the DRP to monitor the raw data directory for new files, to extract metadata from
their FITS headers and store it in the database. This process is referred to as file ingestion.
Standardised file ingestion is performed using the <a class="reference external" href="https://github.com/lsst/astro_metadata_translator">astro_metadata_translator</a> package.
A description of the standard metadata items can be found <a class="reference external" href="https://astro-metadata-translator.lsst.io/py-api/astro_metadata_translator.ObservationInfo.html#astro_metadata_translator.ObservationInfo">here</a>.
Note that the standard metadata contains the <code class="docutils literal notranslate"><span class="pre">observation_type</span></code> key, which identifies the type of
the exposure e.g.bias, dark, flat or science.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">FileIngestor</span></code> service continually monitors the raw data directory for new files and inserts
their metadata into the <code class="docutils literal notranslate"><span class="pre">ExposureCollection</span></code>. In addition to the standard metadata, the <code class="docutils literal notranslate"><span class="pre">FileIngestor</span></code>
will also attempt to measure a set of metrics for each file. These are stored in the nested <code class="docutils literal notranslate"><span class="pre">metrics</span></code>
component of <code class="docutils literal notranslate"><span class="pre">ExposureDocument</span></code> instances.</p>
<p>The service is designed to be as robust as possible. If a file fails ingestion, the error will
be logged and the offending file will not be queued for reprocessing until the service is restarted.
Even in the case of failure, the <code class="docutils literal notranslate"><span class="pre">FileIngestor</span></code> will attempt to record as much metadata as possible;
in the worst case scenario, e.g. if a FITS header cannot be read, the inserted document will only
contain the filename.</p>
<p>NOTE: Currently, the astrometric calibration (WCS) is also performed during ingestion. This happens
at the metric evaluation stage. Unlike all other tasks in <code class="docutils literal notranslate"><span class="pre">huntsman-drp</span></code>, this directly modifies the FITS
headers of the raw files.</p>
</section>
<section id="calibservice">
<h3>CalibService<a class="headerlink" href="#calibservice" title="Permalink to this headline"></a></h3>
</section>
<section id="qualitymonitor">
<h3>QualityMonitor<a class="headerlink" href="#qualitymonitor" title="Permalink to this headline"></a></h3>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="huntsman-drp" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lsst.html" class="btn btn-neutral float-right" title="Integration with LSST" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, danjampro, fergusL, lspitler.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>